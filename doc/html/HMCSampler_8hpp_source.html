<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Robosample: include/gmolmodel/HMCSampler.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Robosample
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_4c2c2cb074c512cbf4ec3fb40742599b.html">gmolmodel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">HMCSampler.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef __HAMMONTECARLOSAMPLER_HPP__</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define __HAMMONTECARLOSAMPLER_HPP__</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* -------------------------------------------------------------------------- *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                               Robosampling                                 *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * -------------------------------------------------------------------------- *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * This is part of Robosampling                                               *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;MonteCarloSampler.hpp&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// Just to remove the long syntax requirement</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#ifndef pHMC</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//#define pHMC(pSampler) dynamic_cast&lt;HMCSampler *&gt;(pSampler)</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#define pHMC(pSampler) pSampler</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keywordtype">void</span> writePdb(SimTK::Compound&amp; c, SimTK::State&amp; advanced,</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *dirname, <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix, <span class="keywordtype">int</span> midlength, <span class="keyword">const</span> <span class="keywordtype">char</span> *sufix, <span class="keywordtype">double</span> aTime);</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="classHMCSampler.html">   33</a></span>&#160;<span class="keyword">class </span><a class="code" href="classHMCSampler.html">HMCSampler</a> : <span class="keyword">virtual</span> <span class="keyword">public</span> <a class="code" href="classMonteCarloSampler.html">MonteCarloSampler</a></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classContext.html">Context</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classHMCSampler.html#abfc3165e0a559567e33bf19b8aea1a47">HMCSampler</a>(SimTK::CompoundSystem *argCompoundSystem</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            ,SimTK::SimbodyMatterSubsystem *argMatter</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            <span class="comment">//,SimTK::Compound *argResidue</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            ,std::vector&lt;Topology *&gt;&amp; argTopologies</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            ,SimTK::DuMMForceFieldSubsystem *argDumm</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            ,SimTK::GeneralForceSubsystem *forces</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            ,SimTK::TimeStepper *argTimeStepper</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            );</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classHMCSampler.html#a1781a161d1a712ed28c973b4b56c3c7f">~HMCSampler</a>();</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a1335bea08f96d449cb9bdb985b3e6b9d">calcSqrtMInvL</a>(SimTK::State&amp; someState, SimTK::Matrix&amp; SqrtMInv);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#ab4f9446e1b9ecb3f47b62637e8bc6fb9">calcSqrtMInvU</a>(SimTK::State&amp; someState, SimTK::Matrix&amp; SqrtMInv);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#ad47e283497806a105dac3c2b15127fbf">calcNumSqrtMUpper</a>(SimTK::State&amp; someState, SimTK::Matrix&amp; SqrtMUpper);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#ad878471d3e5222758b2544f76affd79a">initialize</a>(SimTK::State&amp; advanced);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a43a302d87e149bfa893a5952ec20941f">reinitialize</a>(SimTK::State&amp; advanced) ;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keyword">const</span> SimTK::TimeStepper * <a class="code" href="classHMCSampler.html#a90d64460a0b1b4e83e3c27db0b7681f0">getTimeStepper</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    SimTK::TimeStepper * updTimeStepper(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">void</span> setTimeStepper(SimTK::TimeStepper * someTimeStepper);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">float</span> <a class="code" href="classHMCSampler.html#ab8fb503782cc7fe6951b5189802d174d">getTimestep</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> setTimestep(<span class="keywordtype">float</span>);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    SimTK::Real <a class="code" href="classHMCSampler.html#a97914f58682cd08bacffc115e91499e1">getBoostTemperature</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">void</span> setBoostTemperature(SimTK::Real);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordtype">void</span> setBoostMDSteps(<span class="keywordtype">int</span>);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a8c9a03dba406c0d4bef622c42d399b19">storeOldConfigurationAndPotentialEnergies</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#ae38d8206113980732d4adced081c50fd">initializeVelocities</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a492f12a031effba381c409052ab734e7">calcProposedKineticAndTotalEnergy</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#ab3b4de64be2a10193e274f05788b5ca5">integrateTrajectory</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a4e74ce67f749317e106a528e2791df9d">integrateTrajectoryOneStepAtATime</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#aa3b0a772e2ba3ea1550ec834e887fc67">adaptTimestep</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a90ffe962e5317623389f4db7a85e0592">adaptWorldBlocks</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a4716c29b164a3f9f239266e970498201">calcNewConfigurationAndEnergies</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a26452f17a85fadebcf44bddb44954cc6">setSetConfigurationAndEnergiesToOld</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a4deb485f9bfc31d64f6ada06536f9230">setSetConfigurationAndEnergiesToNew</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">virtual</span> SimTK::Real <a class="code" href="classHMCSampler.html#a7fee5ad6d531c32235db96c4b95f1eca">MHAcceptProbability</a>(SimTK::State&amp; someState, </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    SimTK::Real argEtot_proposed, SimTK::Real argEtot_n);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classHMCSampler.html#af5e87c855b8888196a9f2ad87bb9f824">accRejStep</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#aa36ab4482bbb6295658e8fe6a49c9e4f">propose</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a864175524b6023f505357b10b1a5855b">update</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> sample_iteration(SimTK::State&amp; someState);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classHMCSampler.html#a4c2bd08867d1a07c54587d52fd8d5fed">pushCoordinatesInR</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classHMCSampler.html#a8e67589e5d96c6fe11a20f7bc073af84">pushVelocitiesInRdot</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classHMCSampler.html#aa0e27f4d44328dcae4a2a38cf1b3f626">pushCoordinatesInQ</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classHMCSampler.html#a642722a3022575f342c9913ffbb82ce2">pushVelocitiesInQdot</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classHMCSampler.html#abcdb1f372e12dabec50d4f674c708461">pushVelocitiesInU</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a4abf0550ceb1ecef10c5823581ebf515">perturbQ</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="classHMCSampler.html#aea854d56098d31f7b2e2d15d231b8949">  166</a></span>&#160;    SimTK::Real <a class="code" href="classHMCSampler.html#aea854d56098d31f7b2e2d15d231b8949">getProposedKE</a>(<span class="keywordtype">void</span>) { <span class="keywordflow">return</span> this-&gt;ke_proposed; }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    </div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="classHMCSampler.html#a1e3d6ded4ceb757ab402e6ace268fc2b">  170</a></span>&#160;    SimTK::Real <a class="code" href="classHMCSampler.html#a1e3d6ded4ceb757ab402e6ace268fc2b">getLastAcceptedKE</a>(<span class="keywordtype">void</span>) { <span class="keywordflow">return</span> this-&gt;ke_lastAccepted; }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    </div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a5972926e31fe4f9ee7ae1498f049f9f1">setProposedKE</a>(SimTK::Real);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#a44b541a914af643eaca56e43d5d58a13">setLastAcceptedKE</a>(SimTK::Real);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">int</span> getMDStepsPerSample() <span class="keyword">const</span>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">void</span> setMDStepsPerSample(<span class="keywordtype">int</span> mdStepsPerSample);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classHMCSampler.html#ab0354537f83779a468255e4c5fc2c9b6">PrintDetailedEnergyInfo</a>(SimTK::State&amp; someState);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    SimTK::Real <a class="code" href="classHMCSampler.html#a36bce5b70cae7391ff300b0ca834b84f">calculateMSD</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    SimTK::Real <a class="code" href="classHMCSampler.html#a9d64c28ce62364363fe7c1ff3baceefa">calculateRRdot</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">void</span> geomDihedral(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment">//void loadMbx2mobility(SimTK::State&amp; someState);</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="classHMCSampler.html#a8cd8b25b42e94acb34aa0dea64c67b5b">  201</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="classHMCSampler.html#a8cd8b25b42e94acb34aa0dea64c67b5b">timestep</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">float</span> prevTimestep;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">float</span> prevPrevTimestep;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">bool</span> shouldAdaptTimestep;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    SimTK::Real ke_lastAccepted; <span class="comment">// last accepted kinetic energy</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    SimTK::Real ke_proposed; <span class="comment">// proposed kinetic energy</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    SimTK::Real ke_n; <span class="comment">// new kinetic energy</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    SimTK::Real etot_set; <span class="comment">// stored total energy</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    SimTK::Real etot_proposed; <span class="comment">// last accepted total energ (same with stored)</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    SimTK::Real etot_n;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    SimTK::Real boostT;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    SimTK::Real boostFactor;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    SimTK::Real unboostFactor;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">int</span> boostMDSteps;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">int</span> MDStepsPerSample;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    std::vector&lt;SimTK::Real&gt; R;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    std::vector&lt;SimTK::Real&gt; Rdot;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    std::vector&lt;SimTK::Real&gt; dR;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    std::vector&lt;SimTK::Real&gt; dRdot;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;};</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">#endif // __HAMMONTECARLOSAMPLER_HPP__</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="ttc" id="classHMCSampler_html_a26452f17a85fadebcf44bddb44954cc6"><div class="ttname"><a href="classHMCSampler.html#a26452f17a85fadebcf44bddb44954cc6">HMCSampler::setSetConfigurationAndEnergiesToOld</a></div><div class="ttdeci">virtual void setSetConfigurationAndEnergiesToOld(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:804</div></div>
<div class="ttc" id="classHMCSampler_html_aea854d56098d31f7b2e2d15d231b8949"><div class="ttname"><a href="classHMCSampler.html#aea854d56098d31f7b2e2d15d231b8949">HMCSampler::getProposedKE</a></div><div class="ttdeci">SimTK::Real getProposedKE(void)</div><div class="ttdef"><b>Definition:</b> HMCSampler.hpp:166</div></div>
<div class="ttc" id="classHMCSampler_html_af5e87c855b8888196a9f2ad87bb9f824"><div class="ttname"><a href="classHMCSampler.html#af5e87c855b8888196a9f2ad87bb9f824">HMCSampler::accRejStep</a></div><div class="ttdeci">virtual bool accRejStep(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:823</div></div>
<div class="ttc" id="classHMCSampler_html_ab3b4de64be2a10193e274f05788b5ca5"><div class="ttname"><a href="classHMCSampler.html#ab3b4de64be2a10193e274f05788b5ca5">HMCSampler::integrateTrajectory</a></div><div class="ttdeci">virtual void integrateTrajectory(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:598</div></div>
<div class="ttc" id="classHMCSampler_html_a8e67589e5d96c6fe11a20f7bc073af84"><div class="ttname"><a href="classHMCSampler.html#a8e67589e5d96c6fe11a20f7bc073af84">HMCSampler::pushVelocitiesInRdot</a></div><div class="ttdeci">int pushVelocitiesInRdot(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:929</div></div>
<div class="ttc" id="classHMCSampler_html_ad47e283497806a105dac3c2b15127fbf"><div class="ttname"><a href="classHMCSampler.html#ad47e283497806a105dac3c2b15127fbf">HMCSampler::calcNumSqrtMUpper</a></div><div class="ttdeci">void calcNumSqrtMUpper(SimTK::State &amp;someState, SimTK::Matrix &amp;SqrtMUpper)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:58</div></div>
<div class="ttc" id="classMonteCarloSampler_html"><div class="ttname"><a href="classMonteCarloSampler.html">MonteCarloSampler</a></div><div class="ttdef"><b>Definition:</b> MonteCarloSampler.hpp:22</div></div>
<div class="ttc" id="classHMCSampler_html_a4716c29b164a3f9f239266e970498201"><div class="ttname"><a href="classHMCSampler.html#a4716c29b164a3f9f239266e970498201">HMCSampler::calcNewConfigurationAndEnergies</a></div><div class="ttdeci">virtual void calcNewConfigurationAndEnergies(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:764</div></div>
<div class="ttc" id="classHMCSampler_html_abfc3165e0a559567e33bf19b8aea1a47"><div class="ttname"><a href="classHMCSampler.html#abfc3165e0a559567e33bf19b8aea1a47">HMCSampler::HMCSampler</a></div><div class="ttdeci">HMCSampler(SimTK::CompoundSystem *argCompoundSystem, SimTK::SimbodyMatterSubsystem *argMatter, std::vector&lt; Topology * &gt; &amp;argTopologies, SimTK::DuMMForceFieldSubsystem *argDumm, SimTK::GeneralForceSubsystem *forces, SimTK::TimeStepper *argTimeStepper)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:11</div></div>
<div class="ttc" id="classHMCSampler_html_a90d64460a0b1b4e83e3c27db0b7681f0"><div class="ttname"><a href="classHMCSampler.html#a90d64460a0b1b4e83e3c27db0b7681f0">HMCSampler::getTimeStepper</a></div><div class="ttdeci">const SimTK::TimeStepper * getTimeStepper(void)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:142</div></div>
<div class="ttc" id="classContext_html"><div class="ttname"><a href="classContext.html">Context</a></div><div class="ttdef"><b>Definition:</b> Context.hpp:12</div></div>
<div class="ttc" id="classHMCSampler_html_a90ffe962e5317623389f4db7a85e0592"><div class="ttname"><a href="classHMCSampler.html#a90ffe962e5317623389f4db7a85e0592">HMCSampler::adaptWorldBlocks</a></div><div class="ttdeci">void adaptWorldBlocks(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:498</div></div>
<div class="ttc" id="classHMCSampler_html_a97914f58682cd08bacffc115e91499e1"><div class="ttname"><a href="classHMCSampler.html#a97914f58682cd08bacffc115e91499e1">HMCSampler::getBoostTemperature</a></div><div class="ttdeci">SimTK::Real getBoostTemperature(void)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:323</div></div>
<div class="ttc" id="classHMCSampler_html_a36bce5b70cae7391ff300b0ca834b84f"><div class="ttname"><a href="classHMCSampler.html#a36bce5b70cae7391ff300b0ca834b84f">HMCSampler::calculateMSD</a></div><div class="ttdeci">SimTK::Real calculateMSD(void)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:991</div></div>
<div class="ttc" id="classHMCSampler_html_a7fee5ad6d531c32235db96c4b95f1eca"><div class="ttname"><a href="classHMCSampler.html#a7fee5ad6d531c32235db96c4b95f1eca">HMCSampler::MHAcceptProbability</a></div><div class="ttdeci">virtual SimTK::Real MHAcceptProbability(SimTK::State &amp;someState, SimTK::Real argEtot_proposed, SimTK::Real argEtot_n)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:812</div></div>
<div class="ttc" id="classHMCSampler_html_abcdb1f372e12dabec50d4f674c708461"><div class="ttname"><a href="classHMCSampler.html#abcdb1f372e12dabec50d4f674c708461">HMCSampler::pushVelocitiesInU</a></div><div class="ttdeci">int pushVelocitiesInU(SimTK::State &amp;someState)</div></div>
<div class="ttc" id="classHMCSampler_html_aa3b0a772e2ba3ea1550ec834e887fc67"><div class="ttname"><a href="classHMCSampler.html#aa3b0a772e2ba3ea1550ec834e887fc67">HMCSampler::adaptTimestep</a></div><div class="ttdeci">virtual void adaptTimestep(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:392</div></div>
<div class="ttc" id="classHMCSampler_html_ae38d8206113980732d4adced081c50fd"><div class="ttname"><a href="classHMCSampler.html#ae38d8206113980732d4adced081c50fd">HMCSampler::initializeVelocities</a></div><div class="ttdeci">virtual void initializeVelocities(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:362</div></div>
<div class="ttc" id="classHMCSampler_html_a8cd8b25b42e94acb34aa0dea64c67b5b"><div class="ttname"><a href="classHMCSampler.html#a8cd8b25b42e94acb34aa0dea64c67b5b">HMCSampler::timestep</a></div><div class="ttdeci">float timestep</div><div class="ttdef"><b>Definition:</b> HMCSampler.hpp:201</div></div>
<div class="ttc" id="classHMCSampler_html_a492f12a031effba381c409052ab734e7"><div class="ttname"><a href="classHMCSampler.html#a492f12a031effba381c409052ab734e7">HMCSampler::calcProposedKineticAndTotalEnergy</a></div><div class="ttdeci">virtual void calcProposedKineticAndTotalEnergy(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:382</div></div>
<div class="ttc" id="classHMCSampler_html_a4e74ce67f749317e106a528e2791df9d"><div class="ttname"><a href="classHMCSampler.html#a4e74ce67f749317e106a528e2791df9d">HMCSampler::integrateTrajectoryOneStepAtATime</a></div><div class="ttdeci">virtual void integrateTrajectoryOneStepAtATime(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:619</div></div>
<div class="ttc" id="classHMCSampler_html_ab4f9446e1b9ecb3f47b62637e8bc6fb9"><div class="ttname"><a href="classHMCSampler.html#ab4f9446e1b9ecb3f47b62637e8bc6fb9">HMCSampler::calcSqrtMInvU</a></div><div class="ttdeci">void calcSqrtMInvU(SimTK::State &amp;someState, SimTK::Matrix &amp;SqrtMInv)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:66</div></div>
<div class="ttc" id="classHMCSampler_html_ab0354537f83779a468255e4c5fc2c9b6"><div class="ttname"><a href="classHMCSampler.html#ab0354537f83779a468255e4c5fc2c9b6">HMCSampler::PrintDetailedEnergyInfo</a></div><div class="ttdeci">void PrintDetailedEnergyInfo(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:1029</div></div>
<div class="ttc" id="classHMCSampler_html_a1335bea08f96d449cb9bdb985b3e6b9d"><div class="ttname"><a href="classHMCSampler.html#a1335bea08f96d449cb9bdb985b3e6b9d">HMCSampler::calcSqrtMInvL</a></div><div class="ttdeci">void calcSqrtMInvL(SimTK::State &amp;someState, SimTK::Matrix &amp;SqrtMInv)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:99</div></div>
<div class="ttc" id="classHMCSampler_html_ab8fb503782cc7fe6951b5189802d174d"><div class="ttname"><a href="classHMCSampler.html#ab8fb503782cc7fe6951b5189802d174d">HMCSampler::getTimestep</a></div><div class="ttdeci">virtual float getTimestep(void)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:304</div></div>
<div class="ttc" id="classHMCSampler_html_a642722a3022575f342c9913ffbb82ce2"><div class="ttname"><a href="classHMCSampler.html#a642722a3022575f342c9913ffbb82ce2">HMCSampler::pushVelocitiesInQdot</a></div><div class="ttdeci">int pushVelocitiesInQdot(SimTK::State &amp;someState)</div></div>
<div class="ttc" id="classHMCSampler_html_a1781a161d1a712ed28c973b4b56c3c7f"><div class="ttname"><a href="classHMCSampler.html#a1781a161d1a712ed28c973b4b56c3c7f">HMCSampler::~HMCSampler</a></div><div class="ttdeci">virtual ~HMCSampler()</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:53</div></div>
<div class="ttc" id="classHMCSampler_html_a4deb485f9bfc31d64f6ada06536f9230"><div class="ttname"><a href="classHMCSampler.html#a4deb485f9bfc31d64f6ada06536f9230">HMCSampler::setSetConfigurationAndEnergiesToNew</a></div><div class="ttdeci">virtual void setSetConfigurationAndEnergiesToNew(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:794</div></div>
<div class="ttc" id="classHMCSampler_html_a44b541a914af643eaca56e43d5d58a13"><div class="ttname"><a href="classHMCSampler.html#a44b541a914af643eaca56e43d5d58a13">HMCSampler::setLastAcceptedKE</a></div><div class="ttdeci">void setLastAcceptedKE(SimTK::Real)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:129</div></div>
<div class="ttc" id="classHMCSampler_html_a5972926e31fe4f9ee7ae1498f049f9f1"><div class="ttname"><a href="classHMCSampler.html#a5972926e31fe4f9ee7ae1498f049f9f1">HMCSampler::setProposedKE</a></div><div class="ttdeci">void setProposedKE(SimTK::Real)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:136</div></div>
<div class="ttc" id="classHMCSampler_html_a1e3d6ded4ceb757ab402e6ace268fc2b"><div class="ttname"><a href="classHMCSampler.html#a1e3d6ded4ceb757ab402e6ace268fc2b">HMCSampler::getLastAcceptedKE</a></div><div class="ttdeci">SimTK::Real getLastAcceptedKE(void)</div><div class="ttdef"><b>Definition:</b> HMCSampler.hpp:170</div></div>
<div class="ttc" id="classHMCSampler_html_aa0e27f4d44328dcae4a2a38cf1b3f626"><div class="ttname"><a href="classHMCSampler.html#aa0e27f4d44328dcae4a2a38cf1b3f626">HMCSampler::pushCoordinatesInQ</a></div><div class="ttdeci">int pushCoordinatesInQ(SimTK::State &amp;someState)</div></div>
<div class="ttc" id="classHMCSampler_html_a43a302d87e149bfa893a5952ec20941f"><div class="ttname"><a href="classHMCSampler.html#a43a302d87e149bfa893a5952ec20941f">HMCSampler::reinitialize</a></div><div class="ttdeci">virtual void reinitialize(SimTK::State &amp;advanced)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:245</div></div>
<div class="ttc" id="classHMCSampler_html_a8c9a03dba406c0d4bef622c42d399b19"><div class="ttname"><a href="classHMCSampler.html#a8c9a03dba406c0d4bef622c42d399b19">HMCSampler::storeOldConfigurationAndPotentialEnergies</a></div><div class="ttdeci">virtual void storeOldConfigurationAndPotentialEnergies(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:345</div></div>
<div class="ttc" id="classHMCSampler_html"><div class="ttname"><a href="classHMCSampler.html">HMCSampler</a></div><div class="ttdef"><b>Definition:</b> HMCSampler.hpp:33</div></div>
<div class="ttc" id="classHMCSampler_html_a4abf0550ceb1ecef10c5823581ebf515"><div class="ttname"><a href="classHMCSampler.html#a4abf0550ceb1ecef10c5823581ebf515">HMCSampler::perturbQ</a></div><div class="ttdeci">void perturbQ(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:1048</div></div>
<div class="ttc" id="classHMCSampler_html_aa36ab4482bbb6295658e8fe6a49c9e4f"><div class="ttname"><a href="classHMCSampler.html#aa36ab4482bbb6295658e8fe6a49c9e4f">HMCSampler::propose</a></div><div class="ttdeci">void propose(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:851</div></div>
<div class="ttc" id="classHMCSampler_html_a864175524b6023f505357b10b1a5855b"><div class="ttname"><a href="classHMCSampler.html#a864175524b6023f505357b10b1a5855b">HMCSampler::update</a></div><div class="ttdeci">void update(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:887</div></div>
<div class="ttc" id="classHMCSampler_html_a4c2bd08867d1a07c54587d52fd8d5fed"><div class="ttname"><a href="classHMCSampler.html#a4c2bd08867d1a07c54587d52fd8d5fed">HMCSampler::pushCoordinatesInR</a></div><div class="ttdeci">int pushCoordinatesInR(SimTK::State &amp;someState)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:897</div></div>
<div class="ttc" id="classHMCSampler_html_a9d64c28ce62364363fe7c1ff3baceefa"><div class="ttname"><a href="classHMCSampler.html#a9d64c28ce62364363fe7c1ff3baceefa">HMCSampler::calculateRRdot</a></div><div class="ttdeci">SimTK::Real calculateRRdot(void)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:1002</div></div>
<div class="ttc" id="classHMCSampler_html_ad878471d3e5222758b2544f76affd79a"><div class="ttname"><a href="classHMCSampler.html#ad878471d3e5222758b2544f76affd79a">HMCSampler::initialize</a></div><div class="ttdeci">virtual void initialize(SimTK::State &amp;advanced)</div><div class="ttdef"><b>Definition:</b> HMCSampler.cpp:162</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
