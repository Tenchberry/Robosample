\hypertarget{classLAHMCSampler}{}\section{L\+A\+H\+M\+C\+Sampler Class Reference}
\label{classLAHMCSampler}\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}


{\ttfamily \#include $<$L\+A\+H\+M\+C\+Sampler.\+hpp$>$}



Inheritance diagram for L\+A\+H\+M\+C\+Sampler\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=183pt]{classLAHMCSampler__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for L\+A\+H\+M\+C\+Sampler\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=183pt]{classLAHMCSampler__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classLAHMCSampler_ac139a08ec777cd64d1166cf1b47d77cd}{L\+A\+H\+M\+C\+Sampler} (Sim\+T\+K\+::\+Compound\+System $\ast$arg\+Compound\+System, Sim\+T\+K\+::\+Simbody\+Matter\+Subsystem $\ast$arg\+Matter, std\+::vector$<$ \hyperlink{classTopology}{Topology} $\ast$ $>$ \&topologies, Sim\+T\+K\+::\+Du\+M\+M\+Force\+Field\+Subsystem $\ast$arg\+Dumm, Sim\+T\+K\+::\+General\+Force\+Subsystem $\ast$forces, Sim\+T\+K\+::\+Time\+Stepper $\ast$arg\+Time\+Stepper, unsigned int Kext)
\item 
virtual \hyperlink{classLAHMCSampler_ae6c15a0a2cd4dfc3f6873f5182182a19}{$\sim$\+L\+A\+H\+M\+C\+Sampler} ()
\item 
virtual void \hyperlink{classLAHMCSampler_a4cf1b6d5169675be6687b2eef7e14c61}{initialize} (Sim\+T\+K\+::\+State \&advanced)
\item 
virtual void \hyperlink{classLAHMCSampler_a11e1f9bee0627776686d546efba9d2e6}{reinitialize} (Sim\+T\+K\+::\+State \&advanced)
\item 
void \hyperlink{classLAHMCSampler_a95a06df36c18ea2cad5bea8a7e2b5926}{store\+Old\+Configuration\+And\+Potential\+Energies} (Sim\+T\+K\+::\+State \&some\+State)
\item 
void \hyperlink{classLAHMCSampler_a647e291c4044ca37a4bff16753b76416}{initialize\+Velocities} (Sim\+T\+K\+::\+State \&some\+State)
\item 
void \hyperlink{classLAHMCSampler_a230ea62c24f9873aee71b4fe50049385}{calc\+Proposed\+Kinetic\+And\+Total\+Energy} (Sim\+T\+K\+::\+State \&some\+State)
\item 
void \hyperlink{classLAHMCSampler_a2759e95ec5a15a447a20b59f3df28ef8}{integrate\+Trajectory} (Sim\+T\+K\+::\+State \&some\+State)
\item 
void \hyperlink{classLAHMCSampler_ae90a88374791995683313425966a4b7a}{calc\+New\+Configuration\+And\+Energies} (Sim\+T\+K\+::\+State \&some\+State, int k)
\item 
void {\bfseries reset\+C\+Matrices} (void)\hypertarget{classLAHMCSampler_ae148d78b17cafbacd047dc86a64556d4}{}\label{classLAHMCSampler_ae148d78b17cafbacd047dc86a64556d4}

\item 
Sim\+T\+K\+::\+Matrix {\bfseries extract\+From\+Top} (Sim\+T\+K\+::\+Matrix M, int row\+Cut, int col\+Cut)\hypertarget{classLAHMCSampler_aafbbd957069afd2ef1132414182f869e}{}\label{classLAHMCSampler_aafbbd957069afd2ef1132414182f869e}

\item 
void {\bfseries inject\+From\+Top} (const std\+::vector$<$ Sim\+T\+K\+::\+Real $>$ \&src, std\+::vector$<$ Sim\+T\+K\+::\+Real $>$ \&dest)\hypertarget{classLAHMCSampler_aedd525ca52d9d2a785b851a1480bb0db}{}\label{classLAHMCSampler_aedd525ca52d9d2a785b851a1480bb0db}

\item 
void {\bfseries inject\+From\+Top} (const Sim\+T\+K\+::\+Matrix \&src, Sim\+T\+K\+::\+Matrix \&dest)\hypertarget{classLAHMCSampler_ab0e8be72dae629b8de3e17efe1eea6e8}{}\label{classLAHMCSampler_ab0e8be72dae629b8de3e17efe1eea6e8}

\item 
Sim\+T\+K\+::\+Matrix {\bfseries reverse\+Matrix} (Sim\+T\+K\+::\+Matrix M)\hypertarget{classLAHMCSampler_a6aefd73ab099cdc45a3c999a35871ea0}{}\label{classLAHMCSampler_a6aefd73ab099cdc45a3c999a35871ea0}

\item 
void {\bfseries set\+C\+Entry} (int i, int j, Sim\+T\+K\+::\+Real entry)\hypertarget{classLAHMCSampler_a100856ce2d65a5c3af4a4fa23d03cec2}{}\label{classLAHMCSampler_a100856ce2d65a5c3af4a4fa23d03cec2}

\item 
void {\bfseries set\+Ctau\+Entry} (int i, int j, Sim\+T\+K\+::\+Real entry)\hypertarget{classLAHMCSampler_a9879e684da63e3b2e4a1901358cd6c1e}{}\label{classLAHMCSampler_a9879e684da63e3b2e4a1901358cd6c1e}

\item 
void {\bfseries C\+\_\+to\+\_\+\+Ctau\+\_\+\+Indeces} (int C\+\_\+i, int C\+\_\+j, int \&Ctau\+\_\+i, int \&Ctau\+\_\+j, int curr\+Size)\hypertarget{classLAHMCSampler_a19eb270fc5a18dfd3912f4eb3e8f8c0c}{}\label{classLAHMCSampler_a19eb270fc5a18dfd3912f4eb3e8f8c0c}

\item 
void {\bfseries Ctau\+\_\+to\+\_\+\+C\+\_\+\+Indeces} (int Ctau\+\_\+i, int Ctau\+\_\+j, int \&C\+\_\+i, int \&C\+\_\+j, int curr\+Size)\hypertarget{classLAHMCSampler_a665643ec6077e31d00487df685bb1595}{}\label{classLAHMCSampler_a665643ec6077e31d00487df685bb1595}

\item 
Sim\+T\+K\+::\+Real \hyperlink{classLAHMCSampler_a6a3e967f12c5c64dda41c395bf755e6b}{M\+H\+Accept\+Probability} (Sim\+T\+K\+::\+State \&some\+State, Sim\+T\+K\+::\+Real E\+\_\+o, Sim\+T\+K\+::\+Real E\+\_\+n)
\item 
Sim\+T\+K\+::\+Matrix \& {\bfseries leap\+\_\+prob\+\_\+recurse\+\_\+hard} (Sim\+T\+K\+::\+State \&some\+State, std\+::vector$<$ Sim\+T\+K\+::\+Real $>$ etot\+\_\+ns\+\_\+loc, Sim\+T\+K\+::\+Matrix \&C\+C\+\_\+loc)\hypertarget{classLAHMCSampler_ad41e507cc48b82d7a6b924879a39dec8}{}\label{classLAHMCSampler_ad41e507cc48b82d7a6b924879a39dec8}

\item 
void \hyperlink{classLAHMCSampler_ae7a0d2db9791c6e6947d8273b90f95b8}{set\+Set\+Configuration\+And\+Energies\+To\+New} (Sim\+T\+K\+::\+State \&some\+State)
\item 
void \hyperlink{classLAHMCSampler_aedb4b87feaaa20c036c908c9e9868b41}{propose} (Sim\+T\+K\+::\+State \&some\+State)
\item 
void \hyperlink{classLAHMCSampler_ace1c39b2b136a63d4f00bb5fcd5508c9}{update} (Sim\+T\+K\+::\+State \&some\+State)
\item 
virtual bool \hyperlink{classLAHMCSampler_a0baac57ec1fe8d795a6fea65acdf86ed}{acc\+Rej\+Step} (Sim\+T\+K\+::\+State \&some\+State)
\item 
bool {\bfseries sample\+\_\+iteration} (Sim\+T\+K\+::\+State \&some\+State)\hypertarget{classLAHMCSampler_a0c41a55a68bd21dd21d12c242880495b}{}\label{classLAHMCSampler_a0c41a55a68bd21dd21d12c242880495b}

\item 
Sim\+T\+K\+::\+Real \hyperlink{classLAHMCSampler_a45b90c6c7fb2aa0058190de36049f52e}{get\+Proposed\+KE} (void)
\item 
Sim\+T\+K\+::\+Real \hyperlink{classLAHMCSampler_afa344b5c330421f52c67b7f5f0eee39b}{get\+Last\+Accepted\+KE} (void)
\item 
void \hyperlink{classLAHMCSampler_a784d850d71f9bd99db8b487ed4d8d95e}{set\+Proposed\+KE} (Sim\+T\+K\+::\+Real)
\item 
void \hyperlink{classLAHMCSampler_aa5541db7afb121ab861691c78cf3ed1e}{set\+Last\+Accepted\+KE} (Sim\+T\+K\+::\+Real)
\item 
int {\bfseries get\+M\+D\+Steps\+Per\+Sample} () const \hypertarget{classLAHMCSampler_a21960c0eb41e0f5770889ef746b2d0d3}{}\label{classLAHMCSampler_a21960c0eb41e0f5770889ef746b2d0d3}

\item 
void {\bfseries set\+M\+D\+Steps\+Per\+Sample} (int md\+Steps\+Per\+Sample)\hypertarget{classLAHMCSampler_a23c87fbcec2e0eb55d80fdd46b3b222d}{}\label{classLAHMCSampler_a23c87fbcec2e0eb55d80fdd46b3b222d}

\item 
void \hyperlink{classLAHMCSampler_af62872905cee7ce8de045115a269a670}{Print\+Detailed\+Energy\+Info} (Sim\+T\+K\+::\+State \&some\+State)
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
int {\bfseries K}\hypertarget{classLAHMCSampler_a6fb2d8a9f06d161c5a837c8b912f70fa}{}\label{classLAHMCSampler_a6fb2d8a9f06d161c5a837c8b912f70fa}

\item 
std\+::vector$<$ Sim\+T\+K\+::\+Real $>$ {\bfseries pe\+\_\+ns}\hypertarget{classLAHMCSampler_a5cb7b53a7c914eeea1782a571197b835}{}\label{classLAHMCSampler_a5cb7b53a7c914eeea1782a571197b835}

\item 
std\+::vector$<$ Sim\+T\+K\+::\+Real $>$ {\bfseries fix\+\_\+ns}\hypertarget{classLAHMCSampler_a6257e83ae48c3b849f96d0796bd431e9}{}\label{classLAHMCSampler_a6257e83ae48c3b849f96d0796bd431e9}

\item 
std\+::vector$<$ Sim\+T\+K\+::\+Real $>$ {\bfseries log\+Sine\+Sqr\+Gamma2\+\_\+ns}\hypertarget{classLAHMCSampler_add11d937ef56d4bbf0970ac76e958535}{}\label{classLAHMCSampler_add11d937ef56d4bbf0970ac76e958535}

\item 
std\+::vector$<$ Sim\+T\+K\+::\+Real $>$ {\bfseries ke\+\_\+ns}\hypertarget{classLAHMCSampler_a55d8f1378d5200107fdb8f3abc43a354}{}\label{classLAHMCSampler_a55d8f1378d5200107fdb8f3abc43a354}

\item 
std\+::vector$<$ Sim\+T\+K\+::\+Real $>$ {\bfseries etot\+\_\+ns}\hypertarget{classLAHMCSampler_a6992320ce81d608b84fdea4386b43fbd}{}\label{classLAHMCSampler_a6992320ce81d608b84fdea4386b43fbd}

\item 
Sim\+T\+K\+::\+Matrix {\bfseries C}\hypertarget{classLAHMCSampler_a73138f7fd34e877e393f0409afeffbe1}{}\label{classLAHMCSampler_a73138f7fd34e877e393f0409afeffbe1}

\item 
Sim\+T\+K\+::\+Matrix {\bfseries Ctau}\hypertarget{classLAHMCSampler_a7e9132c332389e404a409d4abb75125b}{}\label{classLAHMCSampler_a7e9132c332389e404a409d4abb75125b}

\item 
Sim\+T\+K\+::\+Matrix {\bfseries P}\hypertarget{classLAHMCSampler_a3a815eae4e31199eae811722b00a6306}{}\label{classLAHMCSampler_a3a815eae4e31199eae811722b00a6306}

\item 
Sim\+T\+K\+::\+Matrix {\bfseries CC}\hypertarget{classLAHMCSampler_ae6bab0d320d3b9d90e26b7cbbb9ace44}{}\label{classLAHMCSampler_ae6bab0d320d3b9d90e26b7cbbb9ace44}

\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
class {\bfseries Context}\hypertarget{classLAHMCSampler_ac26c806e60ca4a0547680edb68f6e39b}{}\label{classLAHMCSampler_ac26c806e60ca4a0547680edb68f6e39b}

\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
A Generalized Coordiantes Hamiltonian Monte Carlo sampler as described in J Chem Theory Comput. 2017 Oct 10;13(10)\+:4649-\/4659. In short it consists of the following steps\+:
\begin{DoxyEnumerate}
\item Initialize velocities from a random normal distribution with a covariance of kT sqrt(\+M) where M is the mass matrix tensor.
\item Propagate the trial trajectory using a symplectic integrator provided by Simbody
\item An acception-\/rejection step which includes the Fixman potential if needed. Step 1 and 2 are implemented in the fuction propose. Step 3 is implemented in the function update. 
\end{DoxyEnumerate}

\subsection{Constructor \& Destructor Documentation}
\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{L\+A\+H\+M\+C\+Sampler(\+Sim\+T\+K\+::\+Compound\+System $\ast$arg\+Compound\+System, Sim\+T\+K\+::\+Simbody\+Matter\+Subsystem $\ast$arg\+Matter, std\+::vector$<$ Topology $\ast$ $>$ \&topologies, Sim\+T\+K\+::\+Du\+M\+M\+Force\+Field\+Subsystem $\ast$arg\+Dumm, Sim\+T\+K\+::\+General\+Force\+Subsystem $\ast$forces, Sim\+T\+K\+::\+Time\+Stepper $\ast$arg\+Time\+Stepper, unsigned int Kext)}{LAHMCSampler(SimTK::CompoundSystem *argCompoundSystem, SimTK::SimbodyMatterSubsystem *argMatter, std::vector< Topology * > &topologies, SimTK::DuMMForceFieldSubsystem *argDumm, SimTK::GeneralForceSubsystem *forces, SimTK::TimeStepper *argTimeStepper, unsigned int Kext)}}]{\setlength{\rightskip}{0pt plus 5cm}L\+A\+H\+M\+C\+Sampler\+::\+L\+A\+H\+M\+C\+Sampler (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+Compound\+System $\ast$}]{arg\+Compound\+System, }
\item[{Sim\+T\+K\+::\+Simbody\+Matter\+Subsystem $\ast$}]{arg\+Matter, }
\item[{std\+::vector$<$ {\bf Topology} $\ast$ $>$ \&}]{topologies, }
\item[{Sim\+T\+K\+::\+Du\+M\+M\+Force\+Field\+Subsystem $\ast$}]{arg\+Dumm, }
\item[{Sim\+T\+K\+::\+General\+Force\+Subsystem $\ast$}]{forces, }
\item[{Sim\+T\+K\+::\+Time\+Stepper $\ast$}]{arg\+Time\+Stepper, }
\item[{unsigned int}]{Kext}
\end{DoxyParamCaption}
)}\hypertarget{classLAHMCSampler_ac139a08ec777cd64d1166cf1b47d77cd}{}\label{classLAHMCSampler_ac139a08ec777cd64d1166cf1b47d77cd}
Constructor \index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!````~L\+A\+H\+M\+C\+Sampler@{$\sim$\+L\+A\+H\+M\+C\+Sampler}}
\index{````~L\+A\+H\+M\+C\+Sampler@{$\sim$\+L\+A\+H\+M\+C\+Sampler}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{$\sim$\+L\+A\+H\+M\+C\+Sampler()}{~LAHMCSampler()}}]{\setlength{\rightskip}{0pt plus 5cm}L\+A\+H\+M\+C\+Sampler\+::$\sim$\+L\+A\+H\+M\+C\+Sampler (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_ae6c15a0a2cd4dfc3f6873f5182182a19}{}\label{classLAHMCSampler_ae6c15a0a2cd4dfc3f6873f5182182a19}
Destructor 

\subsection{Member Function Documentation}
\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!acc\+Rej\+Step@{acc\+Rej\+Step}}
\index{acc\+Rej\+Step@{acc\+Rej\+Step}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{acc\+Rej\+Step(\+Sim\+T\+K\+::\+State \&some\+State)}{accRejStep(SimTK::State &someState)}}]{\setlength{\rightskip}{0pt plus 5cm}bool L\+A\+H\+M\+C\+Sampler\+::acc\+Rej\+Step (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_a0baac57ec1fe8d795a6fea65acdf86ed}{}\label{classLAHMCSampler_a0baac57ec1fe8d795a6fea65acdf86ed}
Accetion rejection step

Acception rejection step 

Reimplemented from \hyperlink{classHMCSampler_af5e87c855b8888196a9f2ad87bb9f824}{H\+M\+C\+Sampler}.

\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!calc\+New\+Configuration\+And\+Energies@{calc\+New\+Configuration\+And\+Energies}}
\index{calc\+New\+Configuration\+And\+Energies@{calc\+New\+Configuration\+And\+Energies}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{calc\+New\+Configuration\+And\+Energies(\+Sim\+T\+K\+::\+State \&some\+State, int k)}{calcNewConfigurationAndEnergies(SimTK::State &someState, int k)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::calc\+New\+Configuration\+And\+Energies (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State, }
\item[{int}]{k}
\end{DoxyParamCaption}
)}\hypertarget{classLAHMCSampler_ae90a88374791995683313425966a4b7a}{}\label{classLAHMCSampler_ae90a88374791995683313425966a4b7a}
Store new configuration and energy terms \index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!calc\+Proposed\+Kinetic\+And\+Total\+Energy@{calc\+Proposed\+Kinetic\+And\+Total\+Energy}}
\index{calc\+Proposed\+Kinetic\+And\+Total\+Energy@{calc\+Proposed\+Kinetic\+And\+Total\+Energy}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{calc\+Proposed\+Kinetic\+And\+Total\+Energy(\+Sim\+T\+K\+::\+State \&some\+State)}{calcProposedKineticAndTotalEnergy(SimTK::State &someState)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::calc\+Proposed\+Kinetic\+And\+Total\+Energy (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_a230ea62c24f9873aee71b4fe50049385}{}\label{classLAHMCSampler_a230ea62c24f9873aee71b4fe50049385}
Store the proposed energies 

Reimplemented from \hyperlink{classHMCSampler_a492f12a031effba381c409052ab734e7}{H\+M\+C\+Sampler}.

\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!get\+Last\+Accepted\+KE@{get\+Last\+Accepted\+KE}}
\index{get\+Last\+Accepted\+KE@{get\+Last\+Accepted\+KE}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{get\+Last\+Accepted\+K\+E(void)}{getLastAcceptedKE(void)}}]{\setlength{\rightskip}{0pt plus 5cm}Sim\+T\+K\+::\+Real L\+A\+H\+M\+C\+Sampler\+::get\+Last\+Accepted\+KE (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classLAHMCSampler_afa344b5c330421f52c67b7f5f0eee39b}{}\label{classLAHMCSampler_afa344b5c330421f52c67b7f5f0eee39b}
Get the stored kinetic energy. This is set rightafter a move is accepted. It\textquotesingle{}s a component of the total energy stored. \index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!get\+Proposed\+KE@{get\+Proposed\+KE}}
\index{get\+Proposed\+KE@{get\+Proposed\+KE}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{get\+Proposed\+K\+E(void)}{getProposedKE(void)}}]{\setlength{\rightskip}{0pt plus 5cm}Sim\+T\+K\+::\+Real L\+A\+H\+M\+C\+Sampler\+::get\+Proposed\+KE (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classLAHMCSampler_a45b90c6c7fb2aa0058190de36049f52e}{}\label{classLAHMCSampler_a45b90c6c7fb2aa0058190de36049f52e}
Modifies Q randomly Get the proposed kinetic energy. This is set right after velocities are initialized. \index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!initialize@{initialize}}
\index{initialize@{initialize}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{initialize(\+Sim\+T\+K\+::\+State \&advanced)}{initialize(SimTK::State &advanced)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::initialize (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_a4cf1b6d5169675be6687b2eef7e14c61}{}\label{classLAHMCSampler_a4cf1b6d5169675be6687b2eef7e14c61}
Calculate O(n2) the square root of the mass matrix inverse denoted by Jain l$\ast$ = \mbox{[}I -\/\+J\+PsiK\mbox{]}$\ast$sqrt(D) (adjoint of l). This is lower triangular Calculate O(n2) the square root of the mass matrix inverse denoted by Jain l = sqrt(\+D) $\ast$ \mbox{[}I -\/\+J\+PsiK\mbox{]}. This is upper triangular Calculate sqrt(\+M) using Eigen. For debug purposes. Seed the random number generator. Set simulation temperature, velocities to desired temperature, variables that store the configuration and variables that store the energies, both needed for the acception-\/rejection step. Also realize velocities and initialize the timestepper.

Get/set the Time\+Stepper that manages the integrator Seed the random number generator. Set simulation temperature, velocities to desired temperature, variables that store the configuration and variables that store the energies, both needed for the acception-\/rejection step. Also realize velocities and initialize the timestepper. 

Reimplemented from \hyperlink{classHMCSampler_ad878471d3e5222758b2544f76affd79a}{H\+M\+C\+Sampler}.

\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!initialize\+Velocities@{initialize\+Velocities}}
\index{initialize\+Velocities@{initialize\+Velocities}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{initialize\+Velocities(\+Sim\+T\+K\+::\+State \&some\+State)}{initializeVelocities(SimTK::State &someState)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::initialize\+Velocities (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_a647e291c4044ca37a4bff16753b76416}{}\label{classLAHMCSampler_a647e291c4044ca37a4bff16753b76416}
Initialize velocities according to the Maxwell-\/\+Boltzmann distribution. Coresponds to R operator in L\+A\+H\+MC 

Reimplemented from \hyperlink{classHMCSampler_ae38d8206113980732d4adced081c50fd}{H\+M\+C\+Sampler}.

\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!integrate\+Trajectory@{integrate\+Trajectory}}
\index{integrate\+Trajectory@{integrate\+Trajectory}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{integrate\+Trajectory(\+Sim\+T\+K\+::\+State \&some\+State)}{integrateTrajectory(SimTK::State &someState)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::integrate\+Trajectory (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_a2759e95ec5a15a447a20b59f3df28ef8}{}\label{classLAHMCSampler_a2759e95ec5a15a447a20b59f3df28ef8}
Apply the L operator 

Reimplemented from \hyperlink{classHMCSampler_ab3b4de64be2a10193e274f05788b5ca5}{H\+M\+C\+Sampler}.

\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!M\+H\+Accept\+Probability@{M\+H\+Accept\+Probability}}
\index{M\+H\+Accept\+Probability@{M\+H\+Accept\+Probability}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{M\+H\+Accept\+Probability(\+Sim\+T\+K\+::\+State \&some\+State, Sim\+T\+K\+::\+Real E\+\_\+o, Sim\+T\+K\+::\+Real E\+\_\+n)}{MHAcceptProbability(SimTK::State &someState, SimTK::Real E_o, SimTK::Real E_n)}}]{\setlength{\rightskip}{0pt plus 5cm}Sim\+T\+K\+::\+Real L\+A\+H\+M\+C\+Sampler\+::\+M\+H\+Accept\+Probability (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State, }
\item[{Sim\+T\+K\+::\+Real}]{arg\+Etot\+\_\+proposed, }
\item[{Sim\+T\+K\+::\+Real}]{arg\+Etot\+\_\+n}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_a6a3e967f12c5c64dda41c395bf755e6b}{}\label{classLAHMCSampler_a6a3e967f12c5c64dda41c395bf755e6b}
Metropolis-\/\+Hastings acceptance probability 

Reimplemented from \hyperlink{classHMCSampler_a7fee5ad6d531c32235db96c4b95f1eca}{H\+M\+C\+Sampler}.

\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!Print\+Detailed\+Energy\+Info@{Print\+Detailed\+Energy\+Info}}
\index{Print\+Detailed\+Energy\+Info@{Print\+Detailed\+Energy\+Info}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{Print\+Detailed\+Energy\+Info(\+Sim\+T\+K\+::\+State \&some\+State)}{PrintDetailedEnergyInfo(SimTK::State &someState)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::\+Print\+Detailed\+Energy\+Info (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State}
\end{DoxyParamCaption}
)}\hypertarget{classLAHMCSampler_af62872905cee7ce8de045115a269a670}{}\label{classLAHMCSampler_af62872905cee7ce8de045115a269a670}
Print detailed energy information \index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!propose@{propose}}
\index{propose@{propose}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{propose(\+Sim\+T\+K\+::\+State \&some\+State)}{propose(SimTK::State &someState)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::propose (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_aedb4b87feaaa20c036c908c9e9868b41}{}\label{classLAHMCSampler_aedb4b87feaaa20c036c908c9e9868b41}
It implements the proposal move in the Hamiltonian Monte Carlo algorithm. It essentially propagates the trajectory after it stores the configuration and energies. T\+O\+DO\+: break in two functions\+: initialize\+Velocities and propagate/integrate 

Reimplemented from \hyperlink{classHMCSampler_aa36ab4482bbb6295658e8fe6a49c9e4f}{H\+M\+C\+Sampler}.

\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!reinitialize@{reinitialize}}
\index{reinitialize@{reinitialize}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{reinitialize(\+Sim\+T\+K\+::\+State \&advanced)}{reinitialize(SimTK::State &advanced)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::reinitialize (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_a11e1f9bee0627776686d546efba9d2e6}{}\label{classLAHMCSampler_a11e1f9bee0627776686d546efba9d2e6}
Same as initialize 

Reimplemented from \hyperlink{classHMCSampler_a43a302d87e149bfa893a5952ec20941f}{H\+M\+C\+Sampler}.

\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!set\+Last\+Accepted\+KE@{set\+Last\+Accepted\+KE}}
\index{set\+Last\+Accepted\+KE@{set\+Last\+Accepted\+KE}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{set\+Last\+Accepted\+K\+E(\+Sim\+T\+K\+::\+Real)}{setLastAcceptedKE(SimTK::Real)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::set\+Last\+Accepted\+KE (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+Real}]{inp\+KE}
\end{DoxyParamCaption}
)}\hypertarget{classLAHMCSampler_aa5541db7afb121ab861691c78cf3ed1e}{}\label{classLAHMCSampler_aa5541db7afb121ab861691c78cf3ed1e}
Stores the accepted kinetic energy. This should be set right after a move is accepted. It\textquotesingle{}s a component of the total energy stored.

Calculate sqrt(\+M) using Eigen. For debug purposes. Calculate O(n2) the square root of the mass matrix inverse denoted by Jain l = sqrt(\+D) $\ast$ \mbox{[}I -\/\+J\+PsiK\mbox{]}. This is upper triangular matrix and it is computed multipling a set of orthonormal vectors with the sqrt(\+M\+Inv). Calculate O(n2) the square root of the mass matrix inverse denoted by Jain l$\ast$ = \mbox{[}I -\/\+J\+PsiK\mbox{]}$\ast$sqrt(D) (adjoint of l). This is lower triangular matrix and it is computed by multipling a set of orthonormal vectors with the sqrt(\+M\+Inv) and transpose it. Stores the accepted kinetic energy. This should be set right after a move is accepted. It\textquotesingle{}s a component of the total energy stored. \index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!set\+Proposed\+KE@{set\+Proposed\+KE}}
\index{set\+Proposed\+KE@{set\+Proposed\+KE}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{set\+Proposed\+K\+E(\+Sim\+T\+K\+::\+Real)}{setProposedKE(SimTK::Real)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::set\+Proposed\+KE (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+Real}]{inp\+KE}
\end{DoxyParamCaption}
)}\hypertarget{classLAHMCSampler_a784d850d71f9bd99db8b487ed4d8d95e}{}\label{classLAHMCSampler_a784d850d71f9bd99db8b487ed4d8d95e}
Sets the proposed kinetic energy before the proposal. This should be set right after the velocities are initialized. \index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!set\+Set\+Configuration\+And\+Energies\+To\+New@{set\+Set\+Configuration\+And\+Energies\+To\+New}}
\index{set\+Set\+Configuration\+And\+Energies\+To\+New@{set\+Set\+Configuration\+And\+Energies\+To\+New}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{set\+Set\+Configuration\+And\+Energies\+To\+New(\+Sim\+T\+K\+::\+State \&some\+State)}{setSetConfigurationAndEnergiesToNew(SimTK::State &someState)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::set\+Set\+Configuration\+And\+Energies\+To\+New (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_ae7a0d2db9791c6e6947d8273b90f95b8}{}\label{classLAHMCSampler_ae7a0d2db9791c6e6947d8273b90f95b8}
Store new configuration and energy terms 

Reimplemented from \hyperlink{classHMCSampler_a4deb485f9bfc31d64f6ada06536f9230}{H\+M\+C\+Sampler}.

\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!store\+Old\+Configuration\+And\+Potential\+Energies@{store\+Old\+Configuration\+And\+Potential\+Energies}}
\index{store\+Old\+Configuration\+And\+Potential\+Energies@{store\+Old\+Configuration\+And\+Potential\+Energies}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{store\+Old\+Configuration\+And\+Potential\+Energies(\+Sim\+T\+K\+::\+State \&some\+State)}{storeOldConfigurationAndPotentialEnergies(SimTK::State &someState)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::store\+Old\+Configuration\+And\+Potential\+Energies (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_a95a06df36c18ea2cad5bea8a7e2b5926}{}\label{classLAHMCSampler_a95a06df36c18ea2cad5bea8a7e2b5926}
Get the Time\+Stepper that manages the integrator Get/\+Set the timestep for integration Get/\+Set boost temperature Store configuration and PE, Fixman potential and logsin gamma squared

Store configuration 

Reimplemented from \hyperlink{classHMCSampler_a8c9a03dba406c0d4bef622c42d399b19}{H\+M\+C\+Sampler}.

\index{L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}!update@{update}}
\index{update@{update}!L\+A\+H\+M\+C\+Sampler@{L\+A\+H\+M\+C\+Sampler}}
\subsubsection[{\texorpdfstring{update(\+Sim\+T\+K\+::\+State \&some\+State)}{update(SimTK::State &someState)}}]{\setlength{\rightskip}{0pt plus 5cm}void L\+A\+H\+M\+C\+Sampler\+::update (
\begin{DoxyParamCaption}
\item[{Sim\+T\+K\+::\+State \&}]{some\+State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLAHMCSampler_ace1c39b2b136a63d4f00bb5fcd5508c9}{}\label{classLAHMCSampler_ace1c39b2b136a63d4f00bb5fcd5508c9}
Main function that contains all the 3 steps of H\+MC. Implements the acception-\/rejection step and sets the state of the compound to the appropriate conformation wether it accepted or not.

Update. 

Reimplemented from \hyperlink{classHMCSampler_a864175524b6023f505357b10b1a5855b}{H\+M\+C\+Sampler}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/gmolmodel/L\+A\+H\+M\+C\+Sampler.\+hpp\item 
src/\hyperlink{LAHMCSampler_8cpp}{L\+A\+H\+M\+C\+Sampler.\+cpp}\end{DoxyCompactItemize}
